<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Agents in Excel: Copilot, Manus &amp; Julius.AI</title>
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      margin: 0;
      padding: 0;
      background: #0b1020;
      color: #f7f7ff;
    }
    header {
      padding: 20px;
      text-align: center;
      background: linear-gradient(90deg, #1b4f72, #6c3483);
    }
    header h1 {
      margin: 0;
      font-size: 1.8rem;
    }
    header p {
      margin: 5px 0 0;
      font-size: 0.95rem;
      opacity: 0.9;
      max-width: 800px;
      margin-left: auto;
      margin-right: auto;
    }
    .container {
      max-width: 1000px;
      margin: 20px auto;
      padding: 0 15px 40px;
    }
    .progress-wrapper {
      margin-bottom: 20px;
    }
    .progress-bar-bg {
      width: 100%;
      height: 14px;
      border-radius: 999px;
      background: #20263d;
      overflow: hidden;
    }
    .progress-bar-fill {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, #1abc9c, #f1c40f);
      transition: width 0.4s;
    }
    .progress-text {
      margin-top: 6px;
      font-size: 0.9rem;
      text-align: right;
      opacity: 0.9;
    }
    .levels {
      display: grid;
      grid-template-columns: 1fr;
      gap: 16px;
    }
    @media (min-width: 800px) {
      .levels {
        grid-template-columns: repeat(3, 1fr);
      }
    }
    .level-card {
      background: #151a30;
      border-radius: 10px;
      border: 1px solid #28304a;
      padding: 14px;
      position: relative;
      display: flex;
      flex-direction: column;
      gap: 8px;
      min-height: 200px;
    }
    .level-title {
      font-weight: 600;
      font-size: 1.1rem;
    }
    .tag {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 0.7rem;
      letter-spacing: 0.03em;
      text-transform: uppercase;
    }
    .tag-unlocked {
      background: #145a32;
      color: #eafaf1;
    }
    .tag-locked {
      background: #641e16;
      color: #f9ebea;
    }
    .level-body {
      font-size: 0.9rem;
      opacity: 0.9;
    }
    .code-input {
      display: flex;
      gap: 6px;
      margin-top: 8px;
    }
    .code-input input {
      flex: 1;
      padding: 6px 8px;
      border-radius: 6px;
      border: 1px solid #3c466a;
      background: #0e1324;
      color: #f7f7ff;
      font-size: 0.85rem;
    }
    .code-input button {
      padding: 6px 10px;
      border-radius: 6px;
      border: none;
      background: #1abc9c;
      color: #081018;
      font-weight: 600;
      font-size: 0.8rem;
      cursor: pointer;
    }
    .code-input button:hover {
      background: #17a589;
    }
    .status-message {
      font-size: 0.8rem;
      margin-top: 4px;
      min-height: 16px;
    }
    .status-ok {
      color: #2ecc71;
    }
    .status-error {
      color: #e74c3c;
    }
    .open-btn {
      margin-top: 8px;
      align-self: flex-start;
      padding: 6px 10px;
      border-radius: 6px;
      border: none;
      background: #3498db;
      color: #f7f7ff;
      font-weight: 600;
      font-size: 0.8rem;
      cursor: pointer;
    }
    .open-btn[disabled] {
      background: #3b4a6a;
      cursor: not-allowed;
      opacity: 0.7;
    }
    .open-btn:not([disabled]):hover {
      background: #2980b9;
    }
    .iframe-wrapper {
      margin-top: 16px;
      border-radius: 10px;
      overflow: hidden;
      border: 1px solid #28304a;
    }
    iframe {
      width: 100%;
      height: 440px;
      border: 0;
      background: white;
    }
    .badge-section {
      margin-top: 30px;
      padding: 14px;
      border-radius: 10px;
      border: 1px dashed #44506f;
      background: #101631;
      font-size: 0.9rem;
    }
    .badge-list span {
      display: inline-block;
      margin: 4px 6px 0 0;
      padding: 3px 8px;
      border-radius: 999px;
      background: #1b263b;
      border: 1px solid #36456b;
      font-size: 0.8rem;
    }
    .hidden {
      display: none;
    }
  </style>
</head>
<body>
<header>
  <h1>Agents in Excel: Copilot, Manus &amp; Julius.AI</h1>
  <p>
    Progress through three short modules that mirror a modern analytics workflow:
    start with assisted insight using Copilot, move to structured automation with Manus,
    and finish with decision-focused analysis using Julius.AI.
  </p>
</header>

<div class="container">
  <!-- Progress -->
  <section class="progress-wrapper">
    <div class="progress-bar-bg">
      <div id="progressFill" class="progress-bar-fill"></div>
    </div>
    <div id="progressText" class="progress-text">Progress: 0 / 3 levels unlocked</div>
  </section>

  <!-- Levels overview / unlock controls -->
  <section class="levels">
    <!-- Level 1 (always unlocked) -->
    <article class="level-card">
      <div class="level-title">Level 1: Copilot – Assisted Insight</div>
      <span class="tag tag-unlocked">Unlocked</span>
      <div class="level-body">
        Use Microsoft Copilot in Excel to explore data, generate formulas,
        and obtain quick summaries using natural language. When you submit the quiz,
        you’ll receive a code that unlocks Level 2 (Manus – Structured Automation).
      </div>
      <button class="open-btn" onclick="loadLevel(1)">Open Level 1</button>
    </article>

    <!-- Level 2 (locked until code) -->
    <article class="level-card">
      <div class="level-title">Level 2: Manus – Structured Automation</div>
      <span id="tagLevel2" class="tag tag-locked">Locked</span>
      <div class="level-body">
        Shift from one-off actions to repeatable processes. Use your completion
        code from the Copilot quiz to unlock this level and work with Manus
        to orchestrate multi-step Excel workflows.
      </div>
      <div class="code-input">
        <input id="codeLevel1" type="text"
               placeholder="Enter code from Copilot (Level 1) confirmation" />
        <button onclick="unlockLevel(2)">Unlock</button>
      </div>
      <div id="statusLevel2" class="status-message"></div>
      <button id="openLevel2Btn" class="open-btn" onclick="loadLevel(2)" disabled>
        Open Level 2
      </button>
    </article>

    <!-- Level 3 (locked until code) -->
    <article class="level-card">
      <div class="level-title">Level 3: Julius.AI – Analytical Intelligence</div>
      <span id="tagLevel3" class="tag tag-locked">Locked</span>
      <div class="level-body">
        Focus on deeper, decision-oriented analysis. Use the completion code
        from the Manus quiz to unlock this level and apply Julius.AI to ask
        richer questions of your data and interpret the results.
      </div>
      <div class="code-input">
        <input id="codeLevel2" type="text"
               placeholder="Enter code from Manus (Level 2) confirmation" />
        <button onclick="unlockLevel(3)">Unlock</button>
      </div>
      <div id="statusLevel3" class="status-message"></div>
      <button id="openLevel3Btn" class="open-btn" onclick="loadLevel(3)" disabled>
        Open Level 3
      </button>
    </article>
  </section>

  <!-- Single Activity Area with one iframe -->
  <section style="margin-top: 30px;">
    <h2>Activity Area</h2>
    <p style="font-size:0.9rem; opacity:0.9;">
      Currently showing:
      <strong><span id="currentLevelName">Level 1: Copilot – Assisted Insight</span></strong>
    </p>
    <div class="iframe-wrapper">
      <!-- This is the ONLY iframe; its src changes when you switch levels -->
      <iframe 
        id="activityFrame"
        src=""
        allowfullscreen>
      </iframe>
    </div>
  </section>

  <!-- Badges -->
  <section class="badge-section">
    <strong>Your Progress Badges</strong>
    <div class="badge-list" id="badgeList">
      <span>Participant</span>
    </div>
    <p id="bonusText" class="hidden" style="margin-top:8px;">
      You’ve completed all three levels. You are now ready to design your own agent‑assisted Excel workflows.
    </p>
  </section>
</div>

<script>
  // 1. Your form embed URLs
  const formUrls = {
    1: "https://docs.google.com/forms/d/e/1FAIpQLSeb0OnQCLD3nlercx2Gd9wXty6QWyvwq787mvXibVKs-chbXg/viewform?embedded=true", // Copilot
    2: "https://docs.google.com/forms/d/e/1FAIpQLSflVLl1iPh3KgXRiuh5IbgA7706j3CfrNGQxMXUCZzz-4G2ng/viewform?embedded=true", // Manus
    3: "https://docs.google.com/forms/d/e/1FAIpQLSeOtanrYiiUQ2KDAxhCJqYnkp92nehWCeSFozFUVBN75j5FmQ/viewform?embedded=true"  // Julius.AI
  };

  // 2. Level display names
  const levelNames = {
    1: "Level 1: Copilot – Assisted Insight",
    2: "Level 2: Manus – Structured Automation",
    3: "Level 3: Julius.AI – Analytical Intelligence"
  };

  // Helper: build codes from character codes + year
  function buildCode(charCodes, year) {
    return String.fromCharCode.apply(null, charCodes) + String(year);
  }

  // 3. Unlock codes (obfuscated: no plain text codes in the HTML)
  // Level 2 code: COPILOT2025  -> [67,79,80,73,76,79,84] + 2025
  // Level 3 code: MANUS2025    -> [77,65,78,85,83] + 2025
  const expectedCodes = {
    2: buildCode([67,79,80,73,76,79,84], 2025),
    3: buildCode([77,65,78,85,83], 2025)
  };

  // Track which levels are unlocked (1 is always unlocked)
  const progressState = {
    1: true,
    2: false,
    3: false
  };

  let currentLevel = 1;

  // Load saved progress from this browser
  (function loadProgress() {
    try {
      const saved = JSON.parse(localStorage.getItem("excelAgentsProgress"));
      if (saved) {
        progressState[2] = !!saved.level2;
        progressState[3] = !!saved.level3;
      }
    } catch (e) {}
    // Initialize UI and default to Level 1 in the iframe
    updateUI();
    loadLevel(1);
  })();

  function saveProgress() {
    const toSave = {
      level2: progressState[2],
      level3: progressState[3]
    };
    localStorage.setItem("excelAgentsProgress", JSON.stringify(toSave));
  }

  function unlockLevel(level) {
    const inputId = level === 2 ? "codeLevel1" : "codeLevel2";
    const statusId = level === 2 ? "statusLevel2" : "statusLevel3";
    const tagId = level === 2 ? "tagLevel2" : "tagLevel3";

    const inputEl = document.getElementById(inputId);
    const statusEl = document.getElementById(statusId);
    const tagEl = document.getElementById(tagId);

    const entered = (inputEl.value || "").trim().toUpperCase();
    const expected = (expectedCodes[level] || "").toUpperCase();

    if (!entered) {
      statusEl.textContent = "Please enter the code shown at the end of the quiz.";
      statusEl.className = "status-message status-error";
      return;
    }

    if (entered === expected) {
      progressState[level] = true;
      saveProgress();
      statusEl.textContent = "Level unlocked. You can now open this level in the activity area.";
      statusEl.className = "status-message status-ok";
      tagEl.textContent = "Unlocked";
      tagEl.className = "tag tag-unlocked";
      updateUI();
    } else {
      statusEl.textContent = "The code does not match. Please check the confirmation message and try again.";
      statusEl.className = "status-message status-error";
    }
  }

  function loadLevel(level) {
    // Only allow loading unlocked levels
    if (!progressState[level]) {
      alert("This level is still locked. Complete the previous quiz and enter the unlock code first.");
      return;
    }
    const frame = document.getElementById("activityFrame");
    const label = document.getElementById("currentLevelName");

    if (!formUrls[level]) {
      frame.src = "";
      label.textContent = "No form URL configured for this level.";
      return;
    }

    currentLevel = level;
    frame.src = formUrls[level];
    label.textContent = levelNames[level] || ("Level " + level);
  }

  function updateUI() {
    // Update unlock tags and buttons
    if (progressState[2]) {
      const tag2 = document.getElementById("tagLevel2");
      tag2.textContent = "Unlocked";
      tag2.className = "tag tag-unlocked";
      const btn2 = document.getElementById("openLevel2Btn");
      btn2.disabled = false;
    }

    if (progressState[3]) {
      const tag3 = document.getElementById("tagLevel3");
      tag3.textContent = "Unlocked";
      tag3.className = "tag tag-unlocked";
      const btn3 = document.getElementById("openLevel3Btn");
      btn3.disabled = false;
    }

    // Update progress bar
    let unlockedCount = 0;
    Object.keys(progressState).forEach(k => {
      if (progressState[k]) unlockedCount++;
    });
    const percent = Math.round((unlockedCount / 3) * 100);
    document.getElementById("progressFill").style.width = percent + "%";
    document.getElementById("progressText").textContent =
      `Progress: ${unlockedCount} / 3 levels unlocked (${percent}%)`;

    // Update badges
    const badgeList = document.getElementById("badgeList");
    badgeList.innerHTML = '<span>Participant</span>';
    if (progressState[1]) badgeList.innerHTML += '<span>Copilot Practitioner</span>';
    if (progressState[2]) badgeList.innerHTML += '<span>Manus Automator</span>';
    if (progressState[3]) badgeList.innerHTML += '<span>Julius.AI Analyst</span>';

    // Bonus message
    const bonusText = document.getElementById("bonusText");
    bonusText.classList.toggle("hidden", !progressState[3]);
  }
</script>
</body>
</html>
